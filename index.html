<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, maximum-scale=5.0, user-scalable=yes, viewport-fit=cover">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="theme-color" content="#007bff">
    <meta name="application-name" content="Budget App">
    <meta name="description" content="A professional budget and expense management app with analytics">
    <meta name="mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="black-translucent">
    <meta name="apple-mobile-web-app-title" content="Budget App">
    <link rel="apple-touch-icon" href="icons/icon-192x192.png">
    <link rel="preconnect" href="https://cdn.jsdelivr.net">
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="stylesheet" href="styles.css">
    <script src="https://cdn.jsdelivr.net/npm/vue@2" defer></script>
    <link rel="manifest" href="manifest.json">
    <title>Budget Expense Tracker</title>
</head>
<body>
    <!-- Skip Link for Accessibility -->
    <a href="#main-content" class="skip-link">Skip to main content</a>
    
    <!-- ARIA Live Region for Screen Reader Announcements -->
    <div id="sr-announcements" class="sr-only" role="status" aria-live="polite" aria-atomic="true"></div>
    <div id="sr-alerts" class="sr-only" role="alert" aria-live="assertive" aria-atomic="true"></div>
    
    <!-- PWA Install Banner -->
    <div id="pwa-install-banner" class="pwa-install-banner" style="display: none;" role="dialog" aria-labelledby="install-title" aria-describedby="install-desc">
        <div class="install-banner-content">
            <div class="install-icon" aria-hidden="true">
                <svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor"><path d="M17 1.01L7 1c-1.1 0-2 .9-2 2v18c0 1.1.9 2 2 2h10c1.1 0 2-.9 2-2V3c0-1.1-.9-1.99-2-1.99zM17 19H7V5h10v14z"/></svg>
            </div>
            <div class="install-text">
                <h3 id="install-title">Add to Home Screen</h3>
                <p id="install-desc">Install our app for the best experience!</p>
            </div>
            <div class="install-actions">
                <button id="install-btn" class="btn-primary" aria-label="Install app">Install</button>
                <button id="dismiss-btn" class="btn-secondary" aria-label="Dismiss install prompt">Not Now</button>
            </div>
        </div>
    </div>

    <div id="app">
        <header class="app-header" role="banner">
            <h1>Budget Expense Tracker</h1>
            <div class="header-controls">
                <button class="color-picker-btn" id="color-picker-btn" aria-label="Customize theme color" aria-haspopup="true" aria-expanded="false">
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true"><path d="M12 3c-4.97 0-9 4.03-9 9s4.03 9 9 9c.83 0 1.5-.67 1.5-1.5 0-.39-.15-.74-.39-1.01-.23-.26-.38-.61-.38-.99 0-.83.67-1.5 1.5-1.5H16c2.76 0 5-2.24 5-5 0-4.42-4.03-8-9-8zm-5.5 9c-.83 0-1.5-.67-1.5-1.5S5.67 9 6.5 9 8 9.67 8 10.5 7.33 12 6.5 12zm3-4C8.67 8 8 7.33 8 6.5S8.67 5 9.5 5s1.5.67 1.5 1.5S10.33 8 9.5 8zm5 0c-.83 0-1.5-.67-1.5-1.5S13.67 5 14.5 5s1.5.67 1.5 1.5S15.33 8 14.5 8zm3 4c-.83 0-1.5-.67-1.5-1.5S16.67 9 17.5 9s1.5.67 1.5 1.5-.67 1.5-1.5 1.5z"/></svg>
                </button>
                <button class="theme-toggle" id="theme-toggle" aria-label="Toggle dark mode" aria-pressed="false">
                    <svg class="icon-moon" width="20" height="20" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true"><path d="M12 3c-4.97 0-9 4.03-9 9s4.03 9 9 9 9-4.03 9-9c0-.46-.04-.92-.1-1.36-.98 1.37-2.58 2.26-4.4 2.26-2.98 0-5.4-2.42-5.4-5.4 0-1.81.89-3.42 2.26-4.4-.44-.06-.9-.1-1.36-.1z"/></svg>
                    <svg class="icon-sun" width="20" height="20" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" style="display:none"><path d="M12 7c-2.76 0-5 2.24-5 5s2.24 5 5 5 5-2.24 5-5-2.24-5-5-5zM2 13h2c.55 0 1-.45 1-1s-.45-1-1-1H2c-.55 0-1 .45-1 1s.45 1 1 1zm18 0h2c.55 0 1-.45 1-1s-.45-1-1-1h-2c-.55 0-1 .45-1 1s.45 1 1 1zM11 2v2c0 .55.45 1 1 1s1-.45 1-1V2c0-.55-.45-1-1-1s-1 .45-1 1zm0 18v2c0 .55.45 1 1 1s1-.45 1-1v-2c0-.55-.45-1-1-1s-1 .45-1 1zM5.99 4.58c-.39-.39-1.03-.39-1.41 0-.39.39-.39 1.03 0 1.41l1.06 1.06c.39.39 1.03.39 1.41 0s.39-1.03 0-1.41L5.99 4.58zm12.37 12.37c-.39-.39-1.03-.39-1.41 0-.39.39-.39 1.03 0 1.41l1.06 1.06c.39.39 1.03.39 1.41 0 .39-.39.39-1.03 0-1.41l-1.06-1.06zm1.06-10.96c.39-.39.39-1.03 0-1.41-.39-.39-1.03-.39-1.41 0l-1.06 1.06c-.39.39-.39 1.03 0 1.41s1.03.39 1.41 0l1.06-1.06zM7.05 18.36c.39-.39.39-1.03 0-1.41-.39-.39-1.03-.39-1.41 0l-1.06 1.06c-.39.39-.39 1.03 0 1.41s1.03.39 1.41 0l1.06-1.06z"/></svg>
                </button>
            </div>
        </header>

        <!-- Color Picker Panel -->
        <div class="color-picker-panel" id="color-picker-panel" role="dialog" aria-labelledby="color-picker-title" aria-hidden="true">
            <div class="color-picker-header">
                <h3 id="color-picker-title">Theme Color</h3>
                <button class="color-picker-close" id="color-picker-close" aria-label="Close color picker">
                    <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true"><path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
                </button>
            </div>
            <div class="color-presets">
                <button class="color-preset" data-color="#007bff" title="Blue">
                    <span class="color-swatch" style="background: #007bff;"></span>
                </button>
                <button class="color-preset" data-color="#ff69b4" title="Hot Pink">
                    <span class="color-swatch" style="background: #ff69b4;"></span>
                </button>
                <button class="color-preset" data-color="#ffb6c1" title="Creamy Pink">
                    <span class="color-swatch" style="background: #ffb6c1;"></span>
                </button>
                <button class="color-preset" data-color="#28a745" title="Green">
                    <span class="color-swatch" style="background: #28a745;"></span>
                </button>
                <button class="color-preset" data-color="#6f42c1" title="Purple">
                    <span class="color-swatch" style="background: #6f42c1;"></span>
                </button>
                <button class="color-preset" data-color="#fd7e14" title="Orange">
                    <span class="color-swatch" style="background: #fd7e14;"></span>
                </button>
                <button class="color-preset" data-color="#17a2b8" title="Teal">
                    <span class="color-swatch" style="background: #17a2b8;"></span>
                </button>
                <button class="color-preset" data-color="#e83e8c" title="Pink">
                    <span class="color-swatch" style="background: #e83e8c;"></span>
                </button>
            </div>
            <div class="custom-color-section">
                <label for="custom-color-input">Custom Color</label>
                <div class="custom-color-wrapper">
                    <input type="color" id="custom-color-input" value="#007bff">
                    <span class="custom-color-value">#007bff</span>
                </div>
            </div>
        </div>

        <!-- Dashboard Page -->
        <main v-show="currentPage === 'dashboard'" class="page-content">
            <!-- Budget Section -->
            <section class="card budget-card" aria-labelledby="budget-card-title">
                <div class="card-header">
                    <div class="card-icon" aria-hidden="true">
                        <svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor"><path d="M11.8 10.9c-2.27-.59-3-1.2-3-2.15 0-1.09 1.01-1.85 2.7-1.85 1.78 0 2.44.85 2.5 2.1h2.21c-.07-1.72-1.12-3.3-3.21-3.81V3h-3v2.16c-1.94.42-3.5 1.68-3.5 3.61 0 2.31 1.91 3.46 4.7 4.13 2.5.6 3 1.48 3 2.41 0 .69-.49 1.79-2.7 1.79-2.06 0-2.87-.92-2.98-2.1h-2.2c.12 2.19 1.76 3.42 3.68 3.83V21h3v-2.15c1.95-.37 3.5-1.5 3.5-3.55 0-2.84-2.43-3.81-4.7-4.4z"/></svg>
                    </div>
                    <h2 class="card-title" id="budget-card-title">{{ budgetEnabled ? 'Set Your Budget' : 'Expense Tracking Mode' }}</h2>
                </div>
                <div class="card-content">
                    <!-- Budget Mode Toggle -->
                    <div class="budget-mode-toggle">
                        <div class="toggle-row">
                            <div class="toggle-info">
                                <span class="toggle-label">Budget Tracking</span>
                                <span class="toggle-description">{{ budgetEnabled ? 'Set a monthly budget to track spending limits' : 'Track expenses without a budget limit' }}</span>
                            </div>
                            <label class="toggle-switch">
                                <input type="checkbox" v-model="budgetEnabled" @change="toggleBudgetEnabled">
                                <span class="toggle-slider"></span>
                            </label>
                        </div>
                    </div>
                    
                    <!-- Budget Form (only shown when budget is enabled) -->
                    <form v-if="budgetEnabled" @submit.prevent="setBudget" class="budget-form">
                        <div class="input-group">
                            <label for="budget" class="input-label">Monthly Budget Amount</label>
                            <div class="input-wrapper">
                                <span class="input-prefix">{{ getCurrencySymbol() }}</span>
                                <input type="number" id="budget" v-model="budget" placeholder="0.00" step="0.01" class="form-input" inputmode="decimal" autocomplete="off" aria-label="Budget amount">
                            </div>
                        </div>
                        <div class="budget-actions">
                            <button type="submit" class="btn-primary">
                                <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true"><path d="M17 3H5c-1.11 0-2 .9-2 2v14c0 1.1.89 2 2 2h14c1.1 0 2-.9 2-2V7l-4-4zm-5 16c-1.66 0-3-1.34-3-3s1.34-3 3-3 3 1.34 3 3-1.34 3-3 3zm3-10H5V5h10v4z"/></svg>
                                Set Budget
                            </button>
                            <button v-if="budget > 0" type="button" @click="clearBudget" class="btn-secondary">
                                <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true"><path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
                                Clear
                            </button>
                        </div>
                    </form>
                    
                    <!-- Expense-only mode message -->
                    <div v-else class="expense-only-info">
                        <div class="info-icon" aria-hidden="true">
                            <svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor"><path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm1 15h-2v-6h2v6zm0-8h-2V7h2v2z"/></svg>
                        </div>
                        <p>You're in expense-tracking mode. Add expenses and see your spending breakdown without setting a budget limit. Enable budget tracking above if you want to set spending limits.</p>
                    </div>
                    
                    <!-- Currency Selector -->
                    <div class="settings-section">
                        <div class="settings-row">
                            <span class="settings-label">Currency</span>
                            <div class="settings-value">
                                <select v-model="currency" @change="setCurrency" class="form-input">
                                    <option v-for="curr in availableCurrencies" :value="curr.code" :key="curr.code">
                                        {{ curr.symbol }} {{ curr.name }}
                                    </option>
                                </select>
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Quick Insights Panel -->
            <section v-if="spendingInsights.length > 0" class="card insights-card">
                <div class="card-header">
                    <div class="card-icon" aria-hidden="true">
                        <svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor"><path d="M9 21c0 .55.45 1 1 1h4c.55 0 1-.45 1-1v-1H9v1zm3-19C8.14 2 5 5.14 5 9c0 2.38 1.19 4.47 3 5.74V17c0 .55.45 1 1 1h6c.55 0 1-.45 1-1v-2.26c1.81-1.27 3-3.36 3-5.74 0-3.86-3.14-7-7-7zm2.85 11.1l-.85.6V16h-4v-2.3l-.85-.6C7.8 12.16 7 10.63 7 9c0-2.76 2.24-5 5-5s5 2.24 5 5c0 1.63-.8 3.16-2.15 4.1z"/></svg>
                    </div>
                    <h2 class="card-title">Quick Insights</h2>
                </div>
                <div class="card-content">
                    <div class="insights-list">
                        <div v-for="(insight, index) in spendingInsights.slice(0, 3)" :key="index" 
                             class="insight-item" :class="'insight-' + insight.type">
                            <div class="insight-icon" aria-hidden="true">
                                <svg v-if="insight.icon === 'fa-lightbulb'" width="20" height="20" viewBox="0 0 24 24" fill="currentColor"><path d="M9 21c0 .55.45 1 1 1h4c.55 0 1-.45 1-1v-1H9v1zm3-19C8.14 2 5 5.14 5 9c0 2.38 1.19 4.47 3 5.74V17c0 .55.45 1 1 1h6c.55 0 1-.45 1-1v-2.26c1.81-1.27 3-3.36 3-5.74 0-3.86-3.14-7-7-7z"/></svg>
                                <svg v-else-if="insight.icon === 'fa-exclamation-triangle'" width="20" height="20" viewBox="0 0 24 24" fill="currentColor"><path d="M1 21h22L12 2 1 21zm12-3h-2v-2h2v2zm0-4h-2v-4h2v4z"/></svg>
                                <svg v-else-if="insight.icon === 'fa-check-circle'" width="20" height="20" viewBox="0 0 24 24" fill="currentColor"><path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-2 15l-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8l-9 9z"/></svg>
                                <svg v-else-if="insight.icon === 'fa-info-circle'" width="20" height="20" viewBox="0 0 24 24" fill="currentColor"><path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm1 15h-2v-6h2v6zm0-8h-2V7h2v2z"/></svg>
                                <svg v-else-if="insight.icon === 'fa-arrow-up'" width="20" height="20" viewBox="0 0 24 24" fill="currentColor"><path d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z"/></svg>
                                <svg v-else-if="insight.icon === 'fa-arrow-down'" width="20" height="20" viewBox="0 0 24 24" fill="currentColor"><path d="M7.41 8.59L12 13.17l4.59-4.58L18 10l-6 6-6-6z"/></svg>
                                <svg v-else width="20" height="20" viewBox="0 0 24 24" fill="currentColor"><path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm1 15h-2v-6h2v6zm0-8h-2V7h2v2z"/></svg>
                            </div>
                            <div class="insight-content">
                                <h4 class="insight-title">{{ insight.title }}</h4>
                                <p class="insight-message">{{ insight.message }}</p>
                            </div>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Summary Cards Grid -->
            <div class="summary-grid">
                <!-- Financial Summary -->
                <section class="card summary-card">
                    <div class="card-header">
                        <div class="card-icon" aria-hidden="true">
                            <svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor"><path d="M5 9.2h3V19H5zM10.6 5h2.8v14h-2.8zm5.6 8H19v6h-2.8z"/></svg>
                        </div>
                        <h2 class="card-title">Financial Summary</h2>
                    </div>
                    <div class="card-content">
                        <div class="summary-items">
                            <!-- Budget row - only shown when budget tracking is enabled -->
                            <div v-if="budgetEnabled" class="summary-item">
                                <span class="summary-label">Budget</span>
                                <span class="summary-value text-primary">{{ formatCurrency(budget) }}</span>
                            </div>
                            <div class="summary-item">
                                <span class="summary-label">Total Expenses</span>
                                <span class="summary-value text-danger">{{ formatCurrency(totalExpenses) }}</span>
                            </div>
                            <!-- Remaining Balance - only shown when budget tracking is enabled -->
                            <div v-if="budgetEnabled && budget > 0" class="summary-item">
                                <span class="summary-label">Remaining Balance</span>
                                <span class="summary-value" :class="remainingBalance >= 0 ? 'text-success' : 'text-danger'">
                                    {{ formatCurrency(remainingBalance) }}
                                    <span v-if="budgetUtilization >= 75" class="budget-warning-badge" :class="budgetUtilization >= 90 ? 'danger' : 'warning'">
                                        <i class="fas fa-exclamation-triangle"></i>
                                        {{ Math.round(budgetUtilization) }}%
                                    </span>
                                </span>
                            </div>
                            <!-- Expense count - shown when budget tracking is disabled -->
                            <div v-if="!budgetEnabled" class="summary-item">
                                <span class="summary-label">Total Expenses</span>
                                <span class="summary-value text-info">{{ expenses.length }} items</span>
                            </div>
                        </div>
                        <div class="deduction-breakdown">
                            <h3 class="breakdown-title">Expense Breakdown</h3>
                            <div class="breakdown-items">
                                <div class="breakdown-item">
                                    <span>Weekly <small class="text-muted">(per week)</small></span>
                                    <span>{{ formatCurrency(deductions.weekly) }}</span>
                                </div>
                                <div class="breakdown-item">
                                    <span>Fortnightly <small class="text-muted">(per fortnight)</small></span>
                                    <span>{{ formatCurrency(deductions.fortnightly) }}</span>
                                </div>
                                <div class="breakdown-item">
                                    <span>Monthly <small class="text-muted">(per month)</small></span>
                                    <span>{{ formatCurrency(deductions.monthly) }}</span>
                                </div>
                                <div class="breakdown-item">
                                    <span>Daily Avg <small class="text-muted">(from monthly)</small></span>
                                    <span>{{ formatCurrency(deductions.daily) }}</span>
                                </div>
                            </div>
                            <div class="monthly-equivalent-section" v-if="totalExpenses > 0">
                                <h4 class="equivalent-title">Monthly Equivalent Total</h4>
                                <p class="equivalent-explanation">All expenses normalized to monthly for budget comparison:</p>
                                <div class="equivalent-items">
                                    <div class="equivalent-item" v-if="deductions.weekly > 0">
                                        <span>Weekly expenses</span>
                                        <span>{{ formatCurrency(deductions.weekly) }} × 4.35 = {{ formatCurrency(deductions.weekly * 4.34524) }}</span>
                                    </div>
                                    <div class="equivalent-item" v-if="deductions.fortnightly > 0">
                                        <span>Fortnightly expenses</span>
                                        <span>{{ formatCurrency(deductions.fortnightly) }} × 2.17 = {{ formatCurrency(deductions.fortnightly * 2.17262) }}</span>
                                    </div>
                                    <div class="equivalent-item" v-if="deductions.monthly > 0">
                                        <span>Monthly expenses</span>
                                        <span>{{ formatCurrency(deductions.monthly) }}</span>
                                    </div>
                                </div>
                                <div class="equivalent-total">
                                    <span><strong>Total Monthly Equivalent:</strong></span>
                                    <span class="total-value">{{ formatCurrency(totalExpenses) }}</span>
                                </div>
                            </div>
                        </div>
                    </div>
                </section>

                <!-- Upcoming Deductions -->
                <section class="card upcoming-deductions-card">
                    <div class="card-header">
                        <div class="card-icon" aria-hidden="true">
                            <svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor"><path d="M19 3h-1V1h-2v2H8V1H6v2H5c-1.11 0-1.99.9-1.99 2L3 19c0 1.1.89 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm0 16H5V8h14v11zM9 10H7v2h2v-2zm4 0h-2v2h2v-2zm4 0h-2v2h2v-2zm-8 4H7v2h2v-2zm4 0h-2v2h2v-2zm4 0h-2v2h2v-2z"/></svg>
                        </div>
                        <h2 class="card-title">Upcoming Expenses</h2>
                    </div>
                    <div class="card-content">
                        <div v-if="upcomingDeductions.length > 0" class="upcoming-list">
                            <div v-for="(expense, index) in upcomingDeductions.slice(0, 5)" :key="expense.id || index" 
                                 class="upcoming-item" :class="{ 'urgent': expense.daysUntil <= 3 }">
                                <div class="upcoming-icon" :style="{ backgroundColor: getCategoryById(expense.category).color }">
                                    <i :class="getCategoryById(expense.category).icon"></i>
                                </div>
                                <div class="upcoming-details">
                                    <h4 class="upcoming-name">{{ expense.name }}</h4>
                                    <div class="upcoming-meta">
                                        <span class="upcoming-amount">{{ formatCurrency(expense.amount) }}</span>
                                        <span class="upcoming-frequency">{{ expense.frequency }}</span>
                                    </div>
                                </div>
                                <div class="upcoming-due">
                                    <span class="days-until" :class="{ 'urgent-text': expense.daysUntil <= 3 }">
                                        {{ expense.daysUntil === 0 ? 'Today' : expense.daysUntil === 1 ? 'Tomorrow' : expense.daysUntil + ' days' }}
                                    </span>
                                    <span class="due-date">{{ formatDate(expense.nextDueDate) }}</span>
                                </div>
                            </div>
                        </div>
                        <div v-else class="empty-state">
                            <div class="empty-icon" aria-hidden="true">
                                <svg width="48" height="48" viewBox="0 0 24 24" fill="currentColor"><path d="M19 3h-1V1h-2v2H8V1H6v2H5c-1.11 0-1.99.9-1.99 2L3 19c0 1.1.89 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm0 16H5V8h14v11zm-7-4h-2v2h2v-2z"/></svg>
                            </div>
                            <p class="empty-text">No upcoming expenses</p>
                        </div>
                    </div>
                </section>
            </div>
        </main>

        <!-- Expenses Page -->
        <main v-show="currentPage === 'expenses'" class="page-content">
            <!-- Add/Edit Expense Form -->
            <section class="card expense-form-card">
                <div class="card-header">
                    <div class="card-icon" aria-hidden="true">
                        <svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor"><path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm5 11h-4v4h-2v-4H7v-2h4V7h2v4h4v2z"/></svg>
                    </div>
                    <h2 class="card-title">{{ isEditing ? 'Edit Expense' : 'Add New Expense' }}</h2>
                </div>
                <div class="card-content">
                    <form @submit.prevent="addExpense" class="expense-form">
                        <div class="form-grid">
                            <div class="input-group">
                                <label for="expense-name" class="input-label">Expense Name</label>
                                <input type="text" id="expense-name" v-model="newExpense.name" placeholder="e.g., Groceries, Rent, Utilities" required class="form-input" autocomplete="off" autocapitalize="words">
                            </div>
                            <div class="input-group">
                                <label for="expense-amount" class="input-label">Amount</label>
                                <div class="input-wrapper">
                                    <span class="input-prefix">{{ getCurrencySymbol() }}</span>
                                    <input type="number" id="expense-amount" v-model="newExpense.amount" placeholder="0.00" step="0.01" required class="form-input" inputmode="decimal" autocomplete="off">
                                </div>
                            </div>
                            <div class="input-group">
                                <label for="expense-frequency" class="input-label">Frequency</label>
                                <select id="expense-frequency" v-model="newExpense.frequency" class="form-input">
                                    <option value="daily">Daily</option>
                                    <option value="weekly">Weekly</option>
                                    <option value="fortnightly">Fortnightly</option>
                                    <option value="monthly">Monthly</option>
                                    <option value="quarterly">Quarterly</option>
                                    <option value="yearly">Yearly</option>
                                </select>
                            </div>
                            <div class="input-group">
                                <label for="expense-category" class="input-label">Category</label>
                                <select id="expense-category" v-model="newExpense.category" class="form-input">
                                    <option v-for="category in expenseCategories" :value="category.id" :key="category.id">
                                        {{ category.name }}
                                    </option>
                                </select>
                            </div>
                        </div>
                        
                        <!-- Schedule Options -->
                        <div class="schedule-section">
                            <div class="form-grid">
                                <!-- Day of Week (for weekly/fortnightly) -->
                                <div v-if="newExpense.frequency === 'weekly' || newExpense.frequency === 'fortnightly'" class="input-group">
                                    <label for="expense-day" class="input-label">Day of Week</label>
                                    <select id="expense-day" v-model="newExpense.day" class="form-input">
                                        <option value="monday">Monday</option>
                                        <option value="tuesday">Tuesday</option>
                                        <option value="wednesday">Wednesday</option>
                                        <option value="thursday">Thursday</option>
                                        <option value="friday">Friday</option>
                                        <option value="saturday">Saturday</option>
                                        <option value="sunday">Sunday</option>
                                    </select>
                                </div>
                                <!-- Day of Month (for monthly/quarterly) -->
                                <div v-if="newExpense.frequency === 'monthly' || newExpense.frequency === 'quarterly'" class="input-group">
                                    <label for="expense-day-of-month" class="input-label">Day of Month</label>
                                    <select id="expense-day-of-month" v-model="newExpense.dayOfMonth" class="form-input">
                                        <option v-for="day in 31" :value="day" :key="day">{{ day }}{{ day === 1 ? 'st' : day === 2 ? 'nd' : day === 3 ? 'rd' : 'th' }}</option>
                                    </select>
                                </div>
                                <!-- Start Date (Optional) -->
                                <div class="input-group">
                                    <label for="expense-start-date" class="input-label">Start Date <span v-if="newExpense.frequency === 'daily' || newExpense.frequency === 'yearly'" class="text-muted">(Required)</span><span v-else class="text-muted">(Optional)</span></label>
                                    <input type="date" id="expense-start-date" v-model="newExpense.startDate" class="form-input" placeholder="When does this expense start?">
                                </div>
                            </div>
                        </div>
                        
                        <!-- Notes Field -->
                        <div class="input-group">
                            <label for="expense-notes" class="input-label">Notes (Optional)</label>
                            <textarea id="expense-notes" v-model="newExpense.notes" placeholder="Add any notes or description..." class="form-input notes-input" rows="2"></textarea>
                        </div>
                        <button type="submit" class="btn-success btn-full">
                            <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true"><path d="M19 13h-6v6h-2v-6H5v-2h6V5h2v6h6v2z"/></svg>
                            {{ isEditing ? 'Update Expense' : 'Add Expense' }}
                        </button>
                        <button v-if="isEditing" type="button" @click="resetNewExpense" class="btn-secondary btn-full" style="margin-top: 8px;">
                            <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true"><path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
                            Cancel Edit
                        </button>
                    </form>
                </div>
            </section>

            <!-- Expenses List -->
            <section class="card expenses-list-card">
                <div class="card-header">
                    <div class="card-icon" aria-hidden="true">
                        <svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor"><path d="M3 13h2v-2H3v2zm0 4h2v-2H3v2zm0-8h2V7H3v2zm4 4h14v-2H7v2zm0 4h14v-2H7v2zM7 7v2h14V7H7z"/></svg>
                    </div>
                    <h2 class="card-title">Your Expenses</h2>
                </div>
                <div class="card-content">
                    <!-- Filter Section -->
                    <div v-if="expenses.length > 0" class="filters-section">
                        <!-- Search Input -->
                        <div class="search-section">
                            <div class="search-input-wrapper">
                                <svg class="search-icon" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true"><path d="M15.5 14h-.79l-.28-.27C15.41 12.59 16 11.11 16 9.5 16 5.91 13.09 3 9.5 3S3 5.91 3 9.5 5.91 16 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19l-4.99-5zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14z"/></svg>
                                <input type="text" v-model="searchQuery" placeholder="Search expenses by name, category, or notes..." class="form-input search-input">
                                <button v-if="searchQuery" @click="searchQuery = ''" class="search-clear-btn" aria-label="Clear search">
                                    <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true"><path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
                                </button>
                            </div>
                        </div>
                        <div class="filter-grid">
                            <div class="input-group">
                                <label for="filter-category" class="input-label">Category</label>
                                <select id="filter-category" v-model="categoryFilter" class="form-input">
                                    <option value="">All Categories</option>
                                    <option v-for="category in expenseCategories" :value="category.id" :key="category.id">
                                        {{ category.name }}
                                    </option>
                                </select>
                            </div>
                            <div class="input-group">
                                <label for="filter-frequency" class="input-label">Frequency</label>
                                <select id="filter-frequency" v-model="frequencyFilter" class="form-input">
                                    <option value="">All Frequencies</option>
                                    <option value="daily">Daily</option>
                                    <option value="weekly">Weekly</option>
                                    <option value="fortnightly">Fortnightly</option>
                                    <option value="monthly">Monthly</option>
                                    <option value="quarterly">Quarterly</option>
                                    <option value="yearly">Yearly</option>
                                </select>
                            </div>
                            <div class="input-group">
                                <label for="sort-by" class="input-label">Sort By</label>
                                <select id="sort-by" v-model="sortBy" class="form-input">
                                    <option value="date-desc">Newest First</option>
                                    <option value="date-asc">Oldest First</option>
                                    <option value="amount-desc">Highest Amount</option>
                                    <option value="amount-asc">Lowest Amount</option>
                                    <option value="name-asc">Name A-Z</option>
                                    <option value="name-desc">Name Z-A</option>
                                </select>
                            </div>
                        </div>
                        <div class="filter-footer">
                            <button @click="clearFilters" class="btn-secondary">
                                <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true"><path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
                                Clear Filters
                            </button>
                            <span class="filter-count">{{ filteredExpenses.length }} of {{ expenses.length }} expenses</span>
                        </div>
                    </div>

                    <!-- Empty States -->
                    <div v-if="filteredExpenses.length === 0 && expenses.length > 0" class="empty-state">
                        <div class="empty-icon" aria-hidden="true">
                            <svg width="48" height="48" viewBox="0 0 24 24" fill="currentColor"><path d="M15.5 14h-.79l-.28-.27C15.41 12.59 16 11.11 16 9.5 16 5.91 13.09 3 9.5 3S3 5.91 3 9.5 5.91 16 9.5 16c1.61 0 3.09-.59 4.23-1.57l.27.28v.79l5 4.99L20.49 19l-4.99-5zm-6 0C7.01 14 5 11.99 5 9.5S7.01 5 9.5 5 14 7.01 14 9.5 11.99 14 9.5 14z"/></svg>
                        </div>
                        <h3 class="empty-title">No matching expenses</h3>
                        <p class="empty-text">Try adjusting your filters or search terms.</p>
                        <button @click="clearFilters" class="btn-secondary">Clear Filters</button>
                    </div>
                    <div v-else-if="expenses.length === 0" class="empty-state">
                        <div class="empty-icon" aria-hidden="true">
                            <svg width="48" height="48" viewBox="0 0 24 24" fill="currentColor"><path d="M19 3H4.99c-1.11 0-1.98.89-1.98 2L3 19c0 1.1.88 2 1.99 2H19c1.1 0 2-.9 2-2V5c0-1.11-.9-2-2-2zm0 12h-4c0 1.66-1.35 3-3 3s-3-1.34-3-3H4.99V5H19v10z"/></svg>
                        </div>
                        <h3 class="empty-title">No expenses yet</h3>
                        <p class="empty-text">Add your first expense using the form above.</p>
                    </div>

                    <!-- Expenses List -->
                    <div v-else class="expenses-list">
                        <div v-for="(expense, index) in filteredExpenses" :key="expense.id || index" class="expense-card">
                            <div class="expense-header">
                                <div class="expense-icon" :style="{ backgroundColor: getCategoryById(expense.category).color }">
                                    <i :class="getCategoryById(expense.category).icon"></i>
                                </div>
                                <div class="expense-main">
                                    <h3 class="expense-name">{{ expense.name }}</h3>
                                    <div class="expense-meta">
                                        <span class="category-tag" :style="{ backgroundColor: getCategoryById(expense.category).color }">
                                            {{ getCategoryById(expense.category).name }}
                                        </span>
                                        <span class="frequency-tag">
                                            <svg width="12" height="12" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true"><path d="M19 3h-1V1h-2v2H8V1H6v2H5c-1.11 0-1.99.9-1.99 2L3 19c0 1.1.89 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm0 16H5V8h14v11zM9 10H7v2h2v-2zm4 0h-2v2h2v-2zm4 0h-2v2h2v-2zm-8 4H7v2h2v-2zm4 0h-2v2h2v-2zm4 0h-2v2h2v-2z"/></svg>
                                            {{ expense.frequency }}
                                        </span>
                                        <span class="day-tag">
                                            <svg width="12" height="12" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true"><path d="M19 3h-1V1h-2v2H8V1H6v2H5c-1.11 0-1.99.9-1.99 2L3 19c0 1.1.89 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm0 16H5V8h14v11zM9 10H7v2h2v-2zm4 0h-2v2h2v-2zm4 0h-2v2h2v-2z"/></svg>
                                            {{ expense.frequency === 'monthly' ? 'Day ' + (expense.dayOfMonth || 1) : expense.day }}
                                        </span>
                                    </div>
                                </div>
                                <div class="expense-amount">
                                    <span class="amount-value">{{ formatCurrency(expense.amount) }}</span>
                                </div>
                            </div>
                            <div v-if="expense.startDate || expense.notes" class="expense-footer">
                                <span v-if="expense.startDate" class="start-date">
                                    <svg width="12" height="12" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true"><path d="M19 3h-1V1h-2v2H8V1H6v2H5c-1.11 0-1.99.9-1.99 2L3 19c0 1.1.89 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm0 16H5V8h14v11z"/></svg>
                                    Started {{ formatDate(expense.startDate) }}
                                </span>
                                <p v-if="expense.notes" class="expense-notes">{{ expense.notes }}</p>
                            </div>
                            <div class="expense-actions">
                                <button @click="editExpense(index)" class="btn-icon btn-warning" title="Edit" aria-label="Edit expense">
                                    <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true"><path d="M3 17.25V21h3.75L17.81 9.94l-3.75-3.75L3 17.25zM20.71 7.04c.39-.39.39-1.02 0-1.41l-2.34-2.34c-.39-.39-1.02-.39-1.41 0l-1.83 1.83 3.75 3.75 1.83-1.83z"/></svg>
                                </button>
                                <button @click="deleteExpense(index)" class="btn-icon btn-danger" title="Delete" aria-label="Delete expense">
                                    <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true"><path d="M6 19c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V7H6v12zM19 4h-3.5l-1-1h-5l-1 1H5v2h14V4z"/></svg>
                                </button>
                            </div>
                        </div>
                    </div>

                    <!-- Action Buttons -->
                    <div v-if="expenses.length > 0" class="action-buttons">
                        <button @click="backupData" class="btn-info">
                            <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true"><path d="M17 3H5c-1.11 0-2 .9-2 2v14c0 1.1.89 2 2 2h14c1.1 0 2-.9 2-2V7l-4-4zm-5 16c-1.66 0-3-1.34-3-3s1.34-3 3-3 3 1.34 3 3-1.34 3-3 3zm3-10H5V5h10v4z"/></svg>
                            Backup
                        </button>
                        <label for="restore-import" class="btn-secondary" style="display: flex; align-items: center; justify-content: center;">
                            <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true"><path d="M12.5 8c-2.65 0-5.05.99-6.9 2.6L2 7v9h9l-3.62-3.62c1.39-1.16 3.16-1.88 5.12-1.88 3.54 0 6.55 2.31 7.6 5.5l2.37-.78C21.08 11.03 17.15 8 12.5 8z"/></svg>
                            Restore
                        </label>
                        <input type="file" id="restore-import" accept=".json" @change="restoreData" style="display: none;">
                        <button @click="clearAllExpenses" class="btn-danger">
                            <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true"><path d="M6 19c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V7H6v12zM19 4h-3.5l-1-1h-5l-1 1H5v2h14V4z"/></svg>
                            Clear All
                        </button>
                    </div>
                </div>
            </section>
        </main>

        <!-- Analytics Page -->
        <main v-show="currentPage === 'analytics'" class="page-content">
            <!-- Analytics Content -->
            <section v-if="expenses.length > 0" class="analytics-section">
                <!-- Spending Insights -->
                <section v-if="spendingInsights.length > 0" class="card insights-card">
                    <div class="card-header">
                        <div class="card-icon" aria-hidden="true">
                            <svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor"><path d="M9 21c0 .55.45 1 1 1h4c.55 0 1-.45 1-1v-1H9v1zm3-19C8.14 2 5 5.14 5 9c0 2.38 1.19 4.47 3 5.74V17c0 .55.45 1 1 1h6c.55 0 1-.45 1-1v-2.26c1.81-1.27 3-3.36 3-5.74 0-3.86-3.14-7-7-7z"/></svg>
                        </div>
                        <h2 class="card-title">Spending Insights</h2>
                    </div>
                    <div class="card-content">
                        <div class="insights-list">
                            <div v-for="(insight, index) in spendingInsights" :key="index" 
                                 class="insight-item" :class="'insight-' + insight.type">
                                <div class="insight-icon" aria-hidden="true">
                                    <svg v-if="insight.icon === 'fa-lightbulb'" width="20" height="20" viewBox="0 0 24 24" fill="currentColor"><path d="M9 21c0 .55.45 1 1 1h4c.55 0 1-.45 1-1v-1H9v1zm3-19C8.14 2 5 5.14 5 9c0 2.38 1.19 4.47 3 5.74V17c0 .55.45 1 1 1h6c.55 0 1-.45 1-1v-2.26c1.81-1.27 3-3.36 3-5.74 0-3.86-3.14-7-7-7z"/></svg>
                                    <svg v-else-if="insight.icon === 'fa-exclamation-triangle'" width="20" height="20" viewBox="0 0 24 24" fill="currentColor"><path d="M1 21h22L12 2 1 21zm12-3h-2v-2h2v2zm0-4h-2v-4h2v4z"/></svg>
                                    <svg v-else-if="insight.icon === 'fa-check-circle'" width="20" height="20" viewBox="0 0 24 24" fill="currentColor"><path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-2 15l-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8l-9 9z"/></svg>
                                    <svg v-else-if="insight.icon === 'fa-info-circle'" width="20" height="20" viewBox="0 0 24 24" fill="currentColor"><path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm1 15h-2v-6h2v6zm0-8h-2V7h2v2z"/></svg>
                                    <svg v-else-if="insight.icon === 'fa-arrow-up'" width="20" height="20" viewBox="0 0 24 24" fill="currentColor"><path d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z"/></svg>
                                    <svg v-else-if="insight.icon === 'fa-arrow-down'" width="20" height="20" viewBox="0 0 24 24" fill="currentColor"><path d="M7.41 8.59L12 13.17l4.59-4.58L18 10l-6 6-6-6z"/></svg>
                                    <svg v-else width="20" height="20" viewBox="0 0 24 24" fill="currentColor"><path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm1 15h-2v-6h2v6zm0-8h-2V7h2v2z"/></svg>
                                </div>
                                <div class="insight-content">
                                    <h4 class="insight-title">{{ insight.title }}</h4>
                                    <p class="insight-message">{{ insight.message }}</p>
                                </div>
                            </div>
                        </div>
                    </div>
                </section>

                <!-- Statistics Overview -->
                <section class="card stats-card">
                    <div class="card-header">
                        <div class="card-icon" aria-hidden="true">
                            <svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor"><path d="M5 9.2h3V19H5zM10.6 5h2.8v14h-2.8zm5.6 8H19v6h-2.8z"/></svg>
                        </div>
                        <h2 class="card-title">Statistics Overview</h2>
                    </div>
                    <div class="card-content">
                        <div class="stats-grid">
                            <div class="stat-box">
                                <div class="stat-icon" aria-hidden="true">
                                    <svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor"><path d="M19 3H5c-1.11 0-2 .9-2 2v14c0 1.1.89 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-2 10h-4v4h-2v-4H7v-2h4V7h2v4h4v2z"/></svg>
                                </div>
                                <div class="stat-info">
                                    <span class="stat-value">{{ expenseStatistics.expenseCount }}</span>
                                    <span class="stat-label">Total Expenses</span>
                                </div>
                            </div>
                            <div class="stat-box">
                                <div class="stat-icon" aria-hidden="true">
                                    <svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor"><path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-7 3c1.93 0 3.5 1.57 3.5 3.5S13.93 13 12 13s-3.5-1.57-3.5-3.5S10.07 6 12 6zm7 13H5v-.23c0-.62.28-1.2.76-1.58C7.47 15.82 9.64 15 12 15s4.53.82 6.24 2.19c.48.38.76.97.76 1.58V19z"/></svg>
                                </div>
                                <div class="stat-info">
                                    <span class="stat-value">{{ formatCurrency(expenseStatistics.averageExpense) }}</span>
                                    <span class="stat-label">Average per Item</span>
                                </div>
                            </div>
                            <div class="stat-box">
                                <div class="stat-icon" aria-hidden="true">
                                    <svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor"><path d="M19 3h-1V1h-2v2H8V1H6v2H5c-1.11 0-1.99.9-1.99 2L3 19c0 1.1.89 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm0 16H5V8h14v11zM9 10H7v2h2v-2zm4 0h-2v2h2v-2zm4 0h-2v2h2v-2zm-8 4H7v2h2v-2zm4 0h-2v2h2v-2zm4 0h-2v2h2v-2z"/></svg>
                                </div>
                                <div class="stat-info">
                                    <span class="stat-value">{{ formatCurrency(expenseStatistics.dailyAverage) }}</span>
                                    <span class="stat-label">Daily Average</span>
                                </div>
                            </div>
                            <div class="stat-box">
                                <div class="stat-icon" aria-hidden="true">
                                    <svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor"><path d="M19 3h-1V1h-2v2H8V1H6v2H5c-1.11 0-1.99.9-1.99 2L3 19c0 1.1.89 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm0 16H5V8h14v11zM9 10H7v2h2v-2zm4 0h-2v2h2v-2zm4 0h-2v2h2v-2zm-8 4H7v2h2v-2zm4 0h-2v2h2v-2zm4 0h-2v2h2v-2z"/></svg>
                                </div>
                                <div class="stat-info">
                                    <span class="stat-value">{{ formatCurrency(expenseStatistics.weeklyAverage) }}</span>
                                    <span class="stat-label">Weekly Average</span>
                                </div>
                            </div>
                        </div>
                        <div v-if="expenseStatistics.highestExpense" class="extreme-expenses">
                            <div class="extreme-item highest">
                                <span class="extreme-label"><svg width="14" height="14" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true"><path d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z"/></svg> Highest Expense</span>
                                <span class="extreme-value">{{ expenseStatistics.highestExpense.name }} - {{ formatCurrency(expenseStatistics.highestExpense.amount) }}/mo</span>
                            </div>
                            <div v-if="expenseStatistics.lowestExpense" class="extreme-item lowest">
                                <span class="extreme-label"><svg width="14" height="14" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true"><path d="M7.41 8.59L12 13.17l4.59-4.58L18 10l-6 6-6-6z"/></svg> Lowest Expense</span>
                                <span class="extreme-value">{{ expenseStatistics.lowestExpense.name }} - {{ formatCurrency(expenseStatistics.lowestExpense.amount) }}/mo</span>
                            </div>
                        </div>
                    </div>
                </section>

                <!-- Charts Grid -->
                <div class="charts-grid">
                    <!-- Category Breakdown Pie Chart -->
                    <section class="card chart-card">
                        <div class="card-header">
                            <div class="card-icon" aria-hidden="true">
                                <svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor"><path d="M11 2v20c-5.07-.5-9-4.79-9-10s3.93-9.5 9-10zm2.03 0v8.99H22c-.47-4.74-4.24-8.52-8.97-8.99zm0 11.01V22c4.74-.47 8.5-4.25 8.97-8.99h-8.97z"/></svg>
                            </div>
                            <h2 class="card-title">Expenses by Category</h2>
                        </div>
                        <div class="card-content">
                            <div class="chart-wrapper">
                                <canvas id="categoryChart"></canvas>
                            </div>
                            <!-- Category Breakdown List -->
                            <div v-if="categoryBreakdown.length > 0" class="category-breakdown-list">
                                <div v-for="category in categoryBreakdown" :key="category.id" class="category-breakdown-item">
                                    <div class="category-info">
                                        <span class="category-color" :style="{ backgroundColor: category.color }"></span>
                                        <span class="category-name">{{ category.name }}</span>
                                    </div>
                                    <div class="category-stats">
                                        <span class="category-amount">{{ formatCurrency(category.amount) }}</span>
                                        <span class="category-percentage">({{ category.percentage }}%)</span>
                                    </div>
                                </div>
                            </div>
                        </div>
                    </section>

                    <!-- Frequency Breakdown Bar Chart -->
                    <section class="card chart-card">
                        <div class="card-header">
                            <div class="card-icon" aria-hidden="true">
                                <svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor"><path d="M5 9.2h3V19H5zM10.6 5h2.8v14h-2.8zm5.6 8H19v6h-2.8z"/></svg>
                            </div>
                            <h2 class="card-title">Expenses by Frequency</h2>
                        </div>
                        <div class="card-content">
                            <div class="chart-wrapper">
                                <canvas id="frequencyChart"></canvas>
                            </div>
                            <div class="frequency-legend">
                                <p class="legend-note"><svg width="14" height="14" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true"><path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm1 15h-2v-6h2v6zm0-8h-2V7h2v2z"/></svg> Chart shows monthly equivalent values for accurate comparison</p>
                            </div>
                        </div>
                    </section>
                </div>

                <!-- Spending Trend Chart -->
                <section v-if="spendingHistory.length >= 2" class="card trend-card">
                    <div class="card-header">
                        <div class="card-icon" aria-hidden="true">
                            <svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor"><path d="M5 9.2h3V19H5zM10.6 5h2.8v14h-2.8zm5.6 8H19v6h-2.8z"/></svg>
                        </div>
                        <h2 class="card-title">Spending Trend</h2>
                    </div>
                    <div class="card-content">
                        <div class="chart-wrapper trend-chart-wrapper">
                            <canvas id="trendChart"></canvas>
                        </div>
                        <div class="trend-summary">
                            <div class="trend-indicator" :class="'trend-' + getSpendingTrend()">
                                <svg v-if="getSpendingTrend() === 'increasing'" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true"><path d="M7.41 15.41L12 10.83l4.59 4.58L18 14l-6-6-6 6z"/></svg>
                                <svg v-else-if="getSpendingTrend() === 'decreasing'" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true"><path d="M7.41 8.59L12 13.17l4.59-4.58L18 10l-6 6-6-6z"/></svg>
                                <svg v-else width="16" height="16" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true"><path d="M19 13H5v-2h14v2z"/></svg>
                                <span>Your spending is {{ getSpendingTrend() }}</span>
                            </div>
                        </div>
                    </div>
                </section>

                <!-- Currency Converter -->
                <section class="card currency-converter-card">
                    <div class="card-header">
                        <div class="card-icon" aria-hidden="true">
                            <svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor"><path d="M6.99 11L3 15l3.99 4v-3H14v-2H6.99v-3zM21 9l-3.99-4v3H10v2h7.01v3L21 9z"/></svg>
                        </div>
                        <h2 class="card-title">Currency Converter</h2>
                    </div>
                    <div class="card-content">
                        <div class="converter-controls">
                            <div class="input-group">
                                <label class="input-label">Convert To</label>
                                <select v-model="currencyConverter.targetCurrency" class="form-input">
                                    <option v-for="curr in availableCurrencies" :value="curr.code" :key="curr.code">
                                        {{ curr.symbol }} {{ curr.name }}
                                    </option>
                                </select>
                            </div>
                            <button @click="fetchExchangeRates" class="btn-primary" :disabled="currencyConverter.isLoading">
                                <svg v-if="currencyConverter.isLoading" width="16" height="16" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true" class="spin-animation"><path d="M12 4V1L8 5l4 4V6c3.31 0 6 2.69 6 6 0 1.01-.25 1.97-.7 2.8l1.46 1.46C19.54 15.03 20 13.57 20 12c0-4.42-3.58-8-8-8zm0 14c-3.31 0-6-2.69-6-6 0-1.01.25-1.97.7-2.8L5.24 7.74C4.46 8.97 4 10.43 4 12c0 4.42 3.58 8 8 8v3l4-4-4-4v3z"/></svg>
                                <svg v-else width="16" height="16" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true"><path d="M12 4V1L8 5l4 4V6c3.31 0 6 2.69 6 6 0 1.01-.25 1.97-.7 2.8l1.46 1.46C19.54 15.03 20 13.57 20 12c0-4.42-3.58-8-8-8zm0 14c-3.31 0-6-2.69-6-6 0-1.01.25-1.97.7-2.8L5.24 7.74C4.46 8.97 4 10.43 4 12c0 4.42 3.58 8 8 8v3l4-4-4-4v3z"/></svg>
                                {{ currencyConverter.isLoading ? 'Updating...' : 'Update Rates' }}
                            </button>
                        </div>
                        
                        <div v-if="currencyConverter.error" class="converter-error">
                            <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true"><path d="M1 21h22L12 2 1 21zm12-3h-2v-2h2v2zm0-4h-2v-4h2v4z"/></svg>
                            {{ currencyConverter.error }}
                        </div>
                        
                        <div v-if="currencyConverter.lastUpdated" class="rates-updated">
                            <svg width="14" height="14" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true"><path d="M11.99 2C6.47 2 2 6.48 2 12s4.47 10 9.99 10C17.52 22 22 17.52 22 12S17.52 2 11.99 2zM12 20c-4.42 0-8-3.58-8-8s3.58-8 8-8 8 3.58 8 8-3.58 8-8 8zm.5-13H11v6l5.25 3.15.75-1.23-4.5-2.67z"/></svg>
                            Rates last updated: {{ new Date(currencyConverter.lastUpdated).toLocaleString() }}
                        </div>
                        
                        <div v-if="Object.keys(currencyConverter.exchangeRates).length > 0" class="converter-results">
                            <div class="converter-result-item">
                                <span class="result-label">Total Monthly Expenses</span>
                                <span class="result-value">{{ getConvertedAmount(totalExpenses, currencyConverter.targetCurrency) || 'N/A' }}</span>
                            </div>
                            <div v-if="budget > 0" class="converter-result-item">
                                <span class="result-label">Budget</span>
                                <span class="result-value">{{ getConvertedAmount(budget, currencyConverter.targetCurrency) || 'N/A' }}</span>
                            </div>
                            <div v-if="budget > 0" class="converter-result-item">
                                <span class="result-label">Remaining</span>
                                <span class="result-value" :class="remainingBalance >= 0 ? 'text-success' : 'text-danger'">
                                    {{ getConvertedAmount(remainingBalance, currencyConverter.targetCurrency) || 'N/A' }}
                                </span>
                            </div>
                        </div>
                        
                        <div class="converter-note">
                            <svg width="14" height="14" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true"><path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm1 15h-2v-6h2v6zm0-8h-2V7h2v2z"/></svg>
                            Exchange rates are provided by ExchangeRate-API and cached for 24 hours.
                        </div>
                    </div>
                </section>

                <!-- Budget vs Actual Comparison -->
                <section v-if="budget > 0" class="card budget-comparison-card">
                    <div class="card-header">
                        <div class="card-icon" aria-hidden="true">
                            <svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor"><path d="M12 3c-4.97 0-9 4.03-9 9s4.03 9 9 9c.83 0 1.5-.67 1.5-1.5 0-.39-.15-.74-.39-1.01-.23-.26-.38-.61-.38-.99 0-.83.67-1.5 1.5-1.5H16c2.76 0 5-2.24 5-5 0-4.42-4.03-8-9-8zm-5.5 9c-.83 0-1.5-.67-1.5-1.5S5.67 9 6.5 9 8 9.67 8 10.5 7.33 12 6.5 12zm3-4C8.67 8 8 7.33 8 6.5S8.67 5 9.5 5s1.5.67 1.5 1.5S10.33 8 9.5 8zm5 0c-.83 0-1.5-.67-1.5-1.5S13.67 5 14.5 5s1.5.67 1.5 1.5S15.33 8 14.5 8zm3 4c-.83 0-1.5-.67-1.5-1.5S16.67 9 17.5 9s1.5.67 1.5 1.5-.67 1.5-1.5 1.5z"/></svg>
                        </div>
                        <h2 class="card-title">Budget vs Actual Spending</h2>
                    </div>
                    <div class="card-content">
                        <div class="budget-progress">
                            <div class="progress-bar">
                                <div class="progress-fill budget-fill" :style="{ width: Math.min(budgetUtilization, 100) + '%' }"></div>
                            </div>
                            <div class="progress-labels">
                                <span class="progress-label">
                                    <span class="label-dot budget-dot"></span>
                                    Budget: {{ formatCurrency(budget) }}
                                </span>
                                <span class="progress-label">
                                    <span class="label-dot actual-dot"></span>
                                    Spent: {{ formatCurrency(totalExpenses) }}
                                </span>
                            </div>
                        </div>
                        <div class="budget-stats">
                            <div class="stat-item">
                                <span class="stat-label">Remaining</span>
                                <span class="stat-value" :class="remainingBalance >= 0 ? 'text-success' : 'text-danger'">
                                    {{ formatCurrency(remainingBalance) }}
                                </span>
                            </div>
                            <div class="stat-item">
                                <span class="stat-label">Utilization</span>
                                <span class="stat-value" :class="budgetUtilization >= 90 ? 'text-danger' : budgetUtilization >= 75 ? 'text-secondary' : 'text-success'">
                                    {{ Math.round(budgetUtilization) }}%
                                </span>
                            </div>
                        </div>
                    </div>
                </section>

                <!-- Category Budget Alerts -->
                <section v-if="Object.keys(categoryBudgets).length > 0" class="card category-budgets-card">
                    <div class="card-header">
                        <div class="card-icon" aria-hidden="true">
                            <svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor"><path d="M21.41 11.58l-9-9C12.05 2.22 11.55 2 11 2H4c-1.1 0-2 .9-2 2v7c0 .55.22 1.05.59 1.42l9 9c.36.36.86.58 1.41.58.55 0 1.05-.22 1.41-.59l7-7c.37-.36.59-.86.59-1.41 0-.55-.23-1.06-.59-1.42zM5.5 7C4.67 7 4 6.33 4 5.5S4.67 4 5.5 4 7 4.67 7 5.5 6.33 7 5.5 7z"/></svg>
                        </div>
                        <h2 class="card-title">Category Budget Status</h2>
                    </div>
                    <div class="card-content">
                        <div class="category-budgets-list">
                            <div v-for="category in expenseCategories" :key="category.id" 
                                 v-if="getCategoryBudget(category.id) > 0" 
                                 class="category-budget-item">
                                <div class="category-budget-header">
                                    <div class="category-info">
                                        <span class="category-color" :style="{ backgroundColor: category.color }"></span>
                                        <span class="category-name">{{ category.name }}</span>
                                    </div>
                                    <div class="category-budget-amounts">
                                        <span class="spent">{{ formatCurrency(getCategorySpending(category.id)) }}</span>
                                        <span class="separator">/</span>
                                        <span class="budget">{{ formatCurrency(getCategoryBudget(category.id)) }}</span>
                                    </div>
                                </div>
                                <div class="category-progress-bar">
                                    <div class="category-progress-fill" 
                                         :style="{ width: Math.min(getCategoryUtilization(category.id), 100) + '%', backgroundColor: category.color }">
                                    </div>
                                </div>
                                <div class="category-budget-footer">
                                    <span class="utilization" :class="{ 'over-budget': getCategoryUtilization(category.id) > 100 }">
                                        {{ Math.round(getCategoryUtilization(category.id)) }}% utilized
                                    </span>
                                </div>
                            </div>
                        </div>
                    </div>
                </section>
            </section>

            <!-- Empty State -->
            <section v-else class="empty-analytics">
                <div class="empty-state">
                    <div class="empty-icon" aria-hidden="true">
                        <svg width="48" height="48" viewBox="0 0 24 24" fill="currentColor"><path d="M5 9.2h3V19H5zM10.6 5h2.8v14h-2.8zm5.6 8H19v6h-2.8z"/></svg>
                    </div>
                    <h2 class="empty-title">No Analytics Yet</h2>
                    <p class="empty-text">Add some expenses to see detailed analytics and insights about your spending patterns.</p>
                    <button @click="switchPage('expenses')" class="btn-primary">
                        <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true"><path d="M19 13h-6v6h-2v-6H5v-2h6V5h2v6h6v2z"/></svg>
                        Add Your First Expense
                    </button>
                </div>
            </section>
        </main>

        <!-- Confirmation Modal -->
        <div v-if="confirmModal.show" class="confirm-modal-overlay show" @click.self="closeConfirmModal">
            <div class="confirm-modal">
                <h3>{{ confirmModal.title }}</h3>
                <p>{{ confirmModal.message }}</p>
                <div class="confirm-modal-actions">
                    <button @click="closeConfirmModal" class="btn-secondary">Cancel</button>
                    <button @click="confirmAction" class="btn-danger">Confirm</button>
                </div>
            </div>
        </div>

        <!-- Settings Page -->
        <main v-show="currentPage === 'settings'" class="page-content">
            <!-- Data Management -->
            <section class="card settings-card">
                <div class="card-header">
                    <div class="card-icon" aria-hidden="true">
                        <svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor"><path d="M19.35 10.04C18.67 6.59 15.64 4 12 4 9.11 4 6.6 5.64 5.35 8.04 2.34 8.36 0 10.91 0 14c0 3.31 2.69 6 6 6h13c2.76 0 5-2.24 5-5 0-2.64-2.05-4.78-4.65-4.96zM17 13l-5 5-5-5h3V9h4v4h3z"/></svg>
                    </div>
                    <h2 class="card-title">Data Management</h2>
                </div>
                <div class="card-content">
                    <div class="settings-list">
                        <div class="settings-item">
                            <div class="settings-item-info">
                                <span class="settings-item-label">Export Data</span>
                                <span class="settings-item-desc">Download all your data as a JSON file</span>
                            </div>
                            <button @click="exportData" class="btn-primary">
                                <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true"><path d="M19 9h-4V3H9v6H5l7 7 7-7zM5 18v2h14v-2H5z"/></svg>
                                Export
                            </button>
                        </div>
                        <div class="settings-item">
                            <div class="settings-item-info">
                                <span class="settings-item-label">Import Data</span>
                                <span class="settings-item-desc">Restore data from a backup file</span>
                            </div>
                            <label for="import-file" class="btn-secondary" style="display: flex; align-items: center;">
                                <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true"><path d="M9 16h6v-6h4l-7-7-7 7h4zm-4 2h14v2H5z"/></svg>
                                Import
                            </label>
                            <input type="file" id="import-file" accept=".json" @change="importData" style="display: none;">
                        </div>
                        <div class="settings-item danger-zone">
                            <div class="settings-item-info">
                                <span class="settings-item-label">Clear All Data</span>
                                <span class="settings-item-desc">Permanently delete all expenses and settings</span>
                            </div>
                            <button @click="clearAllData" class="btn-danger">
                                <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true"><path d="M6 19c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V7H6v12zM19 4h-3.5l-1-1h-5l-1 1H5v2h14V4z"/></svg>
                                Clear All
                            </button>
                        </div>
                    </div>
                </div>
            </section>

            <!-- Category Management -->
            <section class="card categories-card">
                <div class="card-header">
                    <div class="card-icon" aria-hidden="true">
                        <svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor"><path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm-2 15l-5-5 1.41-1.41L10 14.17l7.59-7.59L19 8l-9 9z"/></svg>
                    </div>
                    <h2 class="card-title">Categories</h2>
                </div>
                <div class="card-content">
                    <div class="categories-list">
                        <div v-for="category in expenseCategories" :key="category.id" class="category-item">
                            <div class="category-preview" :style="{ backgroundColor: category.color }">
                                <i :class="category.icon"></i>
                            </div>
                            <div class="category-details">
                                <span class="category-name">{{ category.name }}</span>
                                <span class="category-id">{{ category.id }}</span>
                            </div>
                            <div class="category-actions">
                                <button @click="editCategory(category)" class="btn-icon btn-warning" title="Edit" aria-label="Edit category">
                                    <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true"><path d="M3 17.25V21h3.75L17.81 9.94l-3.75-3.75L3 17.25zM20.71 7.04c.39-.39.39-1.02 0-1.41l-2.34-2.34c-.39-.39-1.02-.39-1.41 0l-1.83 1.83 3.75 3.75 1.83-1.83z"/></svg>
                                </button>
                                <button v-if="!category.isDefault" @click="deleteCategory(category.id)" class="btn-icon btn-danger" title="Delete" aria-label="Delete category">
                                    <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true"><path d="M6 19c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V7H6v12zM19 4h-3.5l-1-1h-5l-1 1H5v2h14V4z"/></svg>
                                </button>
                            </div>
                        </div>
                    </div>
                    <button @click="showAddCategoryModal = true" class="btn-success btn-full" style="margin-top: var(--space-lg);">
                        <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true"><path d="M19 13h-6v6h-2v-6H5v-2h6V5h2v6h6v2z"/></svg>
                        Add New Category
                    </button>
                </div>
            </section>

            <!-- Templates -->
            <section class="card templates-card">
                <div class="card-header">
                    <div class="card-icon" aria-hidden="true">
                        <svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor"><path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-5 14H7v-2h7v2zm3-4H7v-2h10v2zm0-4H7V7h10v2z"/></svg>
                    </div>
                    <h2 class="card-title">Expense Templates</h2>
                </div>
                <div class="card-content">
                    <div v-if="templates.length > 0" class="templates-list">
                        <div v-for="(template, index) in templates" :key="index" class="template-item">
                            <div class="template-info">
                                <span class="template-name">{{ template.name }}</span>
                                <div class="template-meta">
                                    <span class="template-amount">{{ formatCurrency(template.amount) }}</span>
                                    <span class="template-frequency">{{ template.frequency }}</span>
                                </div>
                            </div>
                            <div class="template-actions">
                                <button @click="applyTemplate(template)" class="btn-icon btn-primary" title="Use Template" aria-label="Use template">
                                    <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true"><path d="M19 13h-6v6h-2v-6H5v-2h6V5h2v6h6v2z"/></svg>
                                </button>
                                <button @click="deleteTemplate(index)" class="btn-icon btn-danger" title="Delete" aria-label="Delete template">
                                    <svg width="16" height="16" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true"><path d="M6 19c0 1.1.9 2 2 2h8c1.1 0 2-.9 2-2V7H6v12zM19 4h-3.5l-1-1h-5l-1 1H5v2h14V4z"/></svg>
                                </button>
                            </div>
                        </div>
                    </div>
                    <div v-else class="empty-state">
                        <div class="empty-icon" aria-hidden="true">
                            <svg width="48" height="48" viewBox="0 0 24 24" fill="currentColor"><path d="M19 3H5c-1.1 0-2 .9-2 2v14c0 1.1.9 2 2 2h14c1.1 0 2-.9 2-2V5c0-1.1-.9-2-2-2zm-5 14H7v-2h7v2zm3-4H7v-2h10v2zm0-4H7V7h10v2z"/></svg>
                        </div>
                        <h3 class="empty-title">No Templates Yet</h3>
                        <p class="empty-text">Save an expense as a template for quick entry later.</p>
                    </div>
                </div>
            </section>

            <!-- App Info -->
            <section class="card info-card">
                <div class="card-header">
                    <div class="card-icon" aria-hidden="true">
                        <svg width="24" height="24" viewBox="0 0 24 24" fill="currentColor"><path d="M12 2C6.48 2 2 6.48 2 12s4.48 10 10 10 10-4.48 10-10S17.52 2 12 2zm1 15h-2v-6h2v6zm0-8h-2V7h2v2z"/></svg>
                    </div>
                    <h2 class="card-title">About</h2>
                </div>
                <div class="card-content">
                    <div class="info-list">
                        <div class="info-item">
                            <span class="info-label">Version</span>
                            <span class="info-value">1.0.0</span>
                        </div>
                        <div class="info-item">
                            <span class="info-label">Storage Used</span>
                            <span class="info-value">{{ getStorageUsed() }}</span>
                        </div>
                    </div>
                </div>
            </section>
        </main>

        <!-- Add Category Modal -->
        <div v-if="showAddCategoryModal" class="modal-overlay show" @click.self="showAddCategoryModal = false">
            <div class="modal">
                <div class="modal-header">
                    <h3>{{ editingCategory ? 'Edit Category' : 'Add New Category' }}</h3>
                    <button @click="closeCategoryModal" class="modal-close" aria-label="Close modal">
                        <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true"><path d="M19 6.41L17.59 5 12 10.59 6.41 5 5 6.41 10.59 12 5 17.59 6.41 19 12 13.41 17.59 19 19 17.59 13.41 12z"/></svg>
                    </button>
                </div>
                <div class="modal-body">
                    <div class="input-group">
                        <label for="category-name" class="input-label">Category Name</label>
                        <input type="text" id="category-name" v-model="newCategory.name" placeholder="e.g., Entertainment" class="form-input" autocomplete="off">
                    </div>
                    <div class="input-group">
                        <label class="input-label">Color</label>
                        <div class="color-options">
                            <button v-for="color in categoryColors" :key="color" 
                                    class="color-option" 
                                    :class="{ active: newCategory.color === color }"
                                    :style="{ backgroundColor: color }"
                                    @click="newCategory.color = color"
                                    :aria-label="'Select color ' + color">
                            </button>
                        </div>
                    </div>
                    <div class="input-group">
                        <label class="input-label">Icon</label>
                        <div class="icon-options">
                            <button v-for="icon in categoryIcons" :key="icon" 
                                    class="icon-option" 
                                    :class="{ active: newCategory.icon === icon }"
                                    @click="newCategory.icon = icon"
                                    :aria-label="'Select icon ' + icon">
                                <i :class="icon"></i>
                            </button>
                        </div>
                    </div>
                </div>
                <div class="modal-footer">
                    <button @click="closeCategoryModal" class="btn-secondary">Cancel</button>
                    <button @click="saveCategory" class="btn-primary">
                        {{ editingCategory ? 'Update' : 'Add Category' }}
                    </button>
                </div>
            </div>
        </div>

        <!-- Bottom Navigation -->
        <nav class="bottom-nav" role="navigation" aria-label="Main navigation">
            <button @click="switchPage('dashboard')" :class="{ active: currentPage === 'dashboard' }" class="nav-item" :aria-current="currentPage === 'dashboard' ? 'page' : null">
                <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true"><path d="M10 20v-6h4v6h5v-8h3L12 3 2 12h3v8z"/></svg>
                <span>Dashboard</span>
            </button>
            <button @click="switchPage('expenses')" :class="{ active: currentPage === 'expenses' }" class="nav-item" :aria-current="currentPage === 'expenses' ? 'page' : null">
                <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true"><path d="M3 13h2v-2H3v2zm0 4h2v-2H3v2zm0-8h2V7H3v2zm4 4h14v-2H7v2zm0 4h14v-2H7v2zM7 7v2h14V7H7z"/></svg>
                <span>Expenses</span>
            </button>
            <button @click="switchPage('analytics')" :class="{ active: currentPage === 'analytics' }" class="nav-item" :aria-current="currentPage === 'analytics' ? 'page' : null">
                <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true"><path d="M5 9.2h3V19H5zM10.6 5h2.8v14h-2.8zm5.6 8H19v6h-2.8z"/></svg>
                <span>Analytics</span>
            </button>
            <button @click="switchPage('settings')" :class="{ active: currentPage === 'settings' }" class="nav-item" :aria-current="currentPage === 'settings' ? 'page' : null">
                <svg width="20" height="20" viewBox="0 0 24 24" fill="currentColor" aria-hidden="true"><path d="M19.14 12.94c.04-.31.06-.63.06-.94 0-.31-.02-.63-.06-.94l2.03-1.58c.18-.14.23-.41.12-.61l-1.92-3.32c-.12-.22-.37-.29-.59-.22l-2.39.96c-.5-.38-1.03-.7-1.62-.94l-.36-2.54c-.04-.24-.24-.41-.48-.41h-3.84c-.24 0-.43.17-.47.41l-.36 2.54c-.59.24-1.13.57-1.62.94l-2.39-.96c-.22-.08-.47 0-.59.22L2.74 8.87c-.12.21-.08.47.12.61l2.03 1.58c-.04.31-.06.63-.06.94s.02.63.06.94l-2.03 1.58c-.18.14-.23.41-.12.61l1.92 3.32c.12.22.37.29.59.22l2.39-.96c.5.38 1.03.7 1.62.94l.36 2.54c.05.24.24.41.48.41h3.84c.24 0 .44-.17.47-.41l.36-2.54c.59-.24 1.13-.56 1.62-.94l2.39.96c.22.08.47 0 .59-.22l1.92-3.32c.12-.22.07-.47-.12-.61l-2.01-1.58zM12 15.6c-1.98 0-3.6-1.62-3.6-3.6s1.62-3.6 3.6-3.6 3.6 1.62 3.6 3.6-1.62 3.6-3.6 3.6z"/></svg>
                <span>Settings</span>
            </button>
        </nav>
    </div>
    <div id="error-container"></div>
    <script src="script.js"></script>
</body>
</html>